I"NŞ<p>JAVAæœ‰å‡ ç§å¸¸ç”¨çš„æ•°æ®ç»“æ„ï¼Œä¸»è¦æ˜¯ç»§æ‰¿<strong>Collection</strong>å’Œ<strong>Map</strong>è¿™ä¸¤ä¸ªä¸»è¦æ¥å£çš„æ•°æ®å®ç°ç±»</p>

<p>åœ¨jdk1.7å’Œjdk1.8ä¸­ï¼Œå®ç°ä¼šæœ‰äº›è®¸ä¸åŒï¼Œä¹‹åä¼šåœ¨æ³¨è§£ä¸­æ·»åŠ ä¸¤ç‰ˆæœ¬åŒºåˆ«
ä¸‹é¢åˆ†åˆ«ä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„æ•°æ®ç»“æ„(æŒ‰ç…§ç»§æ‰¿çš„æ¥å£åˆ†ä¸ºä¸¤ç±»)ï¼Œä»¥ä¸‹ä»£ç æˆªå–è‡ª<strong>åŸºäºJAVA8çš„android SDK 28</strong></p>
<h1 id="collection">Collection</h1>
<p><strong>Collection</strong>æ˜¯æœ€åŸºæœ¬çš„é›†åˆæ¥å£ï¼Œä¸€ä¸ª<strong>Collection</strong>ä»£è¡¨ä¸€ç»„<strong>Object</strong>ï¼Œå³<strong>Collection</strong>çš„å…ƒç´ <strong>Elements</strong>ã€‚ä¸€äº›<strong>Collection</strong>å…è®¸ç›¸åŒçš„å…ƒç´ è€Œå¦ä¸€äº›ä¸è¡Œã€‚ä¸€äº›èƒ½æ’åºè€Œå¦ä¸€äº›ä¸è¡Œã€‚<strong>Java SDK</strong>ä¸æä¾›ç›´æ¥ç»§æ‰¿è‡ª<strong>Collection</strong>çš„ç±»ï¼Œ<strong>Java SDK</strong>æä¾›çš„ç±»éƒ½æ˜¯ç»§æ‰¿è‡ª<strong>Collectionçš„</strong>â€œå­æ¥å£â€å¦‚<strong>List</strong>å’Œ<strong>Set</strong>ã€‚</p>

<p>è®º<strong>Collection</strong>çš„å®é™…ç±»å‹å¦‚ä½•ï¼Œå®ƒéƒ½æ”¯æŒä¸€ä¸ª<strong>iterator</strong>()çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª<strong>è¿­ä»£å­</strong>ï¼Œä½¿ç”¨è¯¥è¿­ä»£å­å³å¯é€ä¸€è®¿é—®<strong>Collection</strong>ä¸­æ¯ä¸€ä¸ªå…ƒç´ ã€‚å…¸å‹çš„ç”¨æ³•å¦‚ä¸‹ï¼š</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>Iterator it = collection.iterator(); // è·å¾—ä¸€ä¸ªè¿­ä»£å­
ã€€ã€€ã€€ã€€while(it.hasNext()) {
ã€€ã€€ã€€ã€€ã€€ã€€Object obj = it.next(); // å¾—åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ 
ã€€ã€€ã€€ã€€}
</pre></td></tr></tbody></table></code></pre></div></div>
<p>ç”±<strong>Collection</strong>æ¥å£æ´¾ç”Ÿçš„ä¸¤ä¸ªæ¥å£æ˜¯<strong>List</strong>å’Œ<strong>Set</strong>ã€‚</p>
<h2 id="list">List</h2>
<p><strong>List</strong>æ˜¯æœ‰åºçš„<strong>Collection</strong>ï¼Œä½¿ç”¨æ­¤æ¥å£èƒ½å¤Ÿç²¾ç¡®çš„æ§åˆ¶æ¯ä¸ªå…ƒç´ æ’å…¥çš„ä½ç½®ã€‚ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨ç´¢å¼•ï¼ˆå…ƒç´ åœ¨<strong>List</strong>ä¸­çš„ä½ç½®ï¼Œç±»ä¼¼äºæ•°ç»„ä¸‹æ ‡ï¼‰æ¥è®¿é—®<strong>List</strong>ä¸­çš„å…ƒç´ ï¼Œè¿™ç±»ä¼¼äº<strong>Java</strong>çš„æ•°ç»„ï¼Œä¸ä¹‹åä»‹ç»çš„<strong>Set</strong>ä¸ä¸€æ ·ï¼Œ<strong>List</strong>å…è®¸æœ‰ç›¸åŒçš„å…ƒç´ ã€‚å®ç°<strong>List</strong>æ¥å£çš„å¸¸ç”¨ç±»æœ‰<strong>LinkedList</strong>ï¼Œ<strong>ArrayList</strong>ï¼Œ<strong>Vector</strong>å’Œ<strong>Stack</strong>ã€‚</p>

<h3 id="linkedlistjava78ä¸­åŸºæœ¬æ²¡æœ‰æ”¹åŠ¨">LinkedListï¼ˆJAVA7/8ä¸­åŸºæœ¬æ²¡æœ‰æ”¹åŠ¨ï¼‰</h3>
<p>åŒå‘é“¾è¡¨ç»“æ„ï¼Œé€‚ç”¨äºä¹±åºæ’å…¥ã€åˆ é™¤ã€‚ä½†æŒ‡å®šåºåˆ—æ“ä½œæ€§èƒ½ä¸å¦‚<strong>ArrayList</strong>ã€‚</p>

<p><strong>LinkedList</strong>çš„çˆ¶ç±»æ¥å£ï¼Œä»¥åŠå†…éƒ¨æœ‰å‡ ä¸ªä¸»è¦çš„å˜é‡ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>public class LinkedList&lt;E&gt;
    extends AbstractSequentialList&lt;E&gt;
    implements List&lt;E&gt;, Deque&lt;E&gt;, Cloneable, java.io.Serializable
    
transient int size = 0;//é“¾è¡¨å°ºå¯¸
transient Node&lt;E&gt; first;//é“¾è¡¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æŒ‡é’ˆ
transient Node&lt;E&gt; last;//é“¾è¡¨æœ«å°¾èŠ‚ç‚¹æŒ‡é’ˆ

##æ³¨transientå…³é”®å­—ï¼šå°†ä¸éœ€è¦åºåˆ—åŒ–çš„å±æ€§å‰æ·»åŠ å…³é”®å­—transientï¼Œåºåˆ—åŒ–å¯¹è±¡çš„æ—¶å€™ï¼Œè¿™ä¸ªå±æ€§å°±ä¸ä¼šè¢«åºåˆ—åŒ–ã€‚

</pre></td></tr></tbody></table></code></pre></div></div>
<p><em>æ³¨ï¼šå®ç°äº†Cloneableæ¥å£ï¼Œå³å®ç°clone()å‡½æ•°ã€‚ä»£è¡¨èƒ½è¢«å…‹éš†ã€‚</em>
æ•°æ®ç±»<strong>Node</strong>çš„ç»“æ„</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>  private static class Node&lt;E&gt; {
        E item;//èŠ‚ç‚¹æ•°æ®
        Node&lt;E&gt; next;//å½“å‰èŠ‚ç‚¹ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
        Node&lt;E&gt; prev;//å½“å‰èŠ‚ç‚¹ä¸Šä¸€ä¸ªèŠ‚ç‚¹

        Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) {
            this.item = element;
            this.next = next;
            this.prev = prev;
        }
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="æ„é€ æ–¹æ³•">æ„é€ æ–¹æ³•</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre> public LinkedList() {
 }
 //æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šå…ƒç´ çš„åˆ—è¡¨
 public LinkedList(Collection&lt;? extends E&gt; c) {
        this();
        addAll(c);
}
    
public boolean addAll(Collection&lt;? extends E&gt; c) {
        //å¯å‚è€ƒä¸‹æ–¹çš„addAllè§£æï¼Œå°±æ˜¯åœ¨size(æ­¤æ—¶size = 0)ååŠ å…¥æŒ‡å®šå…ƒç´ çš„åˆ—è¡¨çš„æ•°æ®
        return addAll(size, c);
}
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä»¥ä¸‹æ˜¯ä½¿ç”¨æ—¶çš„å¸¸ç”¨æ–¹æ³•å®ç°ä»£ç ä»¥åŠåˆ†æ:</p>

<p><em>æ³¨ï¼šmodCountæ˜¯çˆ¶ç±»AbstractListä¸­å®šä¹‰çš„ä¸€ä¸ªintå‹çš„å±æ€§è®°å½•äº†ArrayListç»“æ„æ€§å˜åŒ–çš„æ¬¡æ•°ã€‚Listä¸­add()ã€remove()ã€addAll()ã€removeRange()åŠclear()è¿™äº›æ–¹æ³•æ¯è°ƒç”¨ä¸€æ¬¡ï¼ŒmodCountçš„å€¼å°±åŠ 1ã€‚</em></p>

<h4 id="addaddlasteaddinte">add()/addLast(E)/add(int,E)</h4>
<p><strong>add(E)/addLast(E)</strong>:å°†æŒ‡å®šçš„å…ƒç´ æ·»åŠ åˆ°åˆ—è¡¨çš„æœ«å°¾ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>public boolean add(E e) {
        linkLast(e);
        return true;
    }
public void addLast(E e) {
        linkLast(e);
    }
    
    void linkLast(E e) {
        final Node&lt;E&gt; l = last;//è·å–æœ«å°¾èŠ‚ç‚¹
        final Node&lt;E&gt; newNode = new Node&lt;&gt;(l, e, null);//å°†ä¼ å…¥çš„æ•°æ®å°è£…æˆ Node
        last = newNode; 
        if (l == null)//åˆ¤æ–­æ˜¯å¦å­˜åœ¨æœ«å°¾èŠ‚ç‚¹
            first = newNode;//ä¸å­˜åœ¨åˆ™è¯´æ˜é“¾è¡¨ä¸ºç©ºï¼Œç›´æ¥å°†èŠ‚ç‚¹èµ‹å€¼ä¸º newNode
        else
            l.next = newNode;//å¦åˆ™å°†æœ«å°¾èŠ‚ç‚¹çš„nextèµ‹å€¼ä¸º newNode
        size++;
        modCount++;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>add(int,E)</strong>:åœ¨åˆ—è¡¨çš„æŒ‡å®šä½ç½®æ’å…¥æŒ‡å®šçš„å…ƒç´ ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre> public void add(int index, E element) {
        //åˆ¤æ–­indexä¸‹æ ‡æ˜¯å¦åœ¨é“¾è¡¨èŒƒå›´å†…(0=&lt;index&lt;=size),è¶…å‡ºåˆ™æŠ›å‡ºIndexOutOfBoundsException 
        checkPositionIndex(index);

        if (index == size)
            linkLast(element); //æ­¤æ—¶ç›¸å½“äºæ’å…¥æœ«å°¾ï¼Œä¸add(E)æ–¹æ³•ä¸€è‡´
        else
            linkBefore(element, node(index));//é‡ç‚¹çœ‹è¿™ä¸ªæ–¹æ³•ï¼Œæ’å…¥é“¾è¡¨ä¸­é—´
    }
    
     /**
     * åœ¨èŠ‚ç‚¹indexå‰æ’å…¥æ–°èŠ‚ç‚¹
     */
    void linkBefore(E e, Node&lt;E&gt; succ) {
        final Node&lt;E&gt; pred = succ.prev;//è·å¾—indexä½ç½®èŠ‚ç‚¹çš„å‰ç½®èŠ‚ç‚¹
        //åˆ›å»ºæ–°èŠ‚ç‚¹ï¼Œå‰ç½®èŠ‚ç‚¹ä¸ºindexä½ç½®èŠ‚ç‚¹çš„å‰ç½®èŠ‚ç‚¹ï¼Œåç½®èŠ‚ç‚¹ä¸ºindexä½ç½®èŠ‚ç‚¹
        final Node&lt;E&gt; newNode = new Node&lt;&gt;(pred, e, succ);
        succ.prev = newNode;//æ”¹å˜indexä½ç½®èŠ‚ç‚¹çš„å‰ç½®èŠ‚ç‚¹ä¸ºæ–°èŠ‚ç‚¹
        if (pred == null) //åˆ¤æ–­indexä½ç½®èŠ‚ç‚¹çš„å‰ç½®èŠ‚ç‚¹æ˜¯å¦ä¸ºç©º
            first = newNode;    //ä¸ºç©ºä»£è¡¨æ’åœ¨é“¾è¡¨å¤´
        else
            pred.next = newNode;    //ä¸ä¸ºç©ºå°†èŠ‚ç‚¹çš„åç½®èŠ‚ç‚¹è®¾ç½®ä¸ºæ–°èŠ‚ç‚¹
        size++;
        modCount++;
        
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="removeint">remove(int)</h4>
<p><strong>remove(int)</strong>ï¼šåˆ é™¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre> public E remove(int index) {
        /**åˆ¤æ–­indexä¸‹æ ‡æ˜¯å¦åœ¨é“¾è¡¨ç´¢å¼•èŒƒå›´å†…(0=&lt;index&lt;size),è¶…å‡ºåˆ™æŠ›å‡ºIndexOutOfBoundsException**/
        checkElementIndex(index);
        return unlink(node(index));//node(index)è·å–åˆ°äº†indexä¸‹è¡¨çš„Node
    }
    
    E unlink(Node&lt;E&gt; x) {
        // assert x != null;
        final E element = x.item;
        final Node&lt;E&gt; next = x.next;
        final Node&lt;E&gt; prev = x.prev;
        //åˆ¤æ–­å‰ç½®èŠ‚ç‚¹æ˜¯å¦ä¸ºnullã€‚
        if (prev == null) {
            first = next;//ä¸ºç©ºåˆ™ä»£è¡¨æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†åç½®èŠ‚ç‚¹è®¾ç½®ä¸ºé¦–ä½èŠ‚ç‚¹
        } else {
            //ä¸ä¸ºç©ºåˆ™ä»£è¡¨æ˜¯ä¸­é—´èŠ‚ç‚¹ï¼Œå°†å‰ç½®èŠ‚ç‚¹çš„åç½®èŠ‚ç‚¹è®¾ç½®ä¸ºè‡ªå·±çš„åç›´èŠ‚ç‚¹ï¼Œæ–­å¼€è‡ªå·±ä¸å‰ç½®èŠ‚ç‚¹çš„é“¾æ¥ã€‚
            prev.next = next 
            x.prev = null;
        }
        //åŒæ ·çš„æ–¹å¼åˆ¤æ–­åç½®
        if (next == null) {
            last = prev;
        } else {
            next.prev = prev;
            x.next = null;
        }
            
        x.item = null;//å½“å‰èŠ‚ç‚¹çš„æ•°æ®ç½®null
        size--;
        modCount++;
        return element; 
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="getint">get(int)</h4>
<p><strong>get(int)</strong>:Returns the element at the specified position in this list.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>public E get(int index){
        /**åˆ¤æ–­indexä¸‹æ ‡æ˜¯å¦åœ¨é“¾è¡¨ç´¢å¼•èŒƒå›´å†…(0=&lt;index&lt;size),è¶…å‡ºåˆ™æŠ›å‡ºIndexOutOfBoundsException**/
        checkElementIndex(index);
        return node(index).item;
    }
    
    /**
    *   è¿”å›æŒ‡å®šå…ƒç´ ç´¢å¼•å¤„çš„(éç©º)èŠ‚ç‚¹ã€‚
    */
    Node&lt;E&gt; node(int index) {
        /**size &gt;&gt; 1ç›¸å½“äºsize/2**/
        if (index &lt; (size &gt;&gt; 1)) { 
          /**å¦‚æœè·å–indexå°äºsize/2ï¼Œåˆ™ä»é¦–ä½èŠ‚ç‚¹å¼€å§‹å¾ªç¯è·å–**/
            Node&lt;E&gt; x = first;  
            for (int i = 0; i &lt; index; i++)
                x = x.next;
            return x;
        } else {
          /**å¦‚æœè·å–indexå¤§äºsize/2ï¼Œåˆ™ä»æœ«å°¾èŠ‚ç‚¹å¼€å§‹å¾ªç¯è·å–**/
            Node&lt;E&gt; x = last;
            for (int i = size - 1; i &gt; index; i--)
                x = x.prev;
            return x;
        }
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="setinte">set(int,E)</h4>
<p><strong>set(int,E)</strong>:å°†åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ æ›¿æ¢ä¸ºæŒ‡å®šçš„å…ƒç´ ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>  public E set(int index, E element) {
        /**åˆ¤æ–­indexä¸‹æ ‡æ˜¯å¦åœ¨é“¾è¡¨ç´¢å¼•èŒƒå›´å†…(0=&lt;index&lt;size),è¶…å‡ºåˆ™æŠ›å‡ºIndexOutOfBoundsException**/
        checkElementIndex(index);
        Node&lt;E&gt; x = node(index);
        E oldVal = x.item;
        x.item = element;
        return oldVal;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="addallcollection-extends-eaddallint--collection-extends-e">addAll(Collection&lt;? extends E&gt;)/addAll(int , Collection&lt;? extends E&gt;)</h4>
<p><strong>addAll(Collection&lt;? extends E&gt;)/addAll(int , Collection&lt;? extends E&gt;)</strong>
ï¼šå°†æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ åˆ°æœ«å°¾/indexèŠ‚ç‚¹ä¹‹å</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre></td><td class="rouge-code"><pre>   //æœ¬è´¨ä¸Šæ˜¯è°ƒç”¨åŒä¸ªæ–¹æ³•
   public boolean addAll(Collection&lt;? extends E&gt; c) {
        return addAll(size, c);//ä¼ å…¥size,ç›´æ¥åœ¨æœ«å°¾æ’å…¥
    }
    
    public boolean addAll(int index, Collection&lt;? extends E&gt; c) {
        //åˆ¤æ–­æ’å…¥ä½ç½®indexæ˜¯å¦è¶…å‡ºèŒƒå›´
        checkPositionIndex(index);
        //å°†é›†åˆè½¬æˆæ•°ç»„
        Object[] a = c.toArray();
        int numNew = a.length;
        //é›†åˆæ•°ä¸º0ï¼Œç­‰äºæ²¡æœ‰æ•°æ®
        if (numNew == 0)
            return false;

        //predpredæ˜¯æ’å…¥èŠ‚ç‚¹é›†åˆçš„å‰ç½®èŠ‚ç‚¹
        //succæ˜¯æ’å…¥ä½ç½®èŠ‚ç‚¹ï¼Œç”¨äºä¹‹ååˆ¤æ–­æ˜¯ä¸­é—´æ’å…¥è¿˜æ˜¯æœ«å°¾æ’å…¥
        Node&lt;E&gt; pred, succ;
        if (index == size) {
            //indexç­‰äºé“¾è¡¨å°ºå¯¸ï¼Œä»£è¡¨æ˜¯æœ«å°¾æ’å…¥
            succ = null;
            pred = last;
        } else {
            //ä¸­é—´æ’å…¥ï¼Œä¿ç•™æ’å…¥ä½ç½®çš„èŠ‚ç‚¹
            succ = node(index); 
            pred = succ.prev;
        }

        for (Object o : a) {
            @SuppressWarnings("unchecked") E e = (E) o;
            Node&lt;E&gt; newNode = new Node&lt;&gt;(pred, e, null);
            if (pred == null) 
                //å‰ç½®èŠ‚ç‚¹ä¸ºnull,ç›¸å½“äºæ’å…¥é“¾è¡¨å¤´
                first = newNode;
            else
                //ä¸ä¸ºç©ºï¼Œåˆ™ä»æ’å…¥ä½ç½®ä¹‹åæ’å…¥
                pred.next = newNode;
            pred = newNode;
        }
        //æ’å…¥å®Œæˆåï¼Œåˆ¤æ–­æ’å…¥ä½ç½®succ
        if (succ == null) {
            //succä¸ºnull,ä»£è¡¨æœ«å°¾æ’å…¥
            last = pred;
        } else {
            //succä¸ä¸ºnull,ä»£è¡¨ä¸­é—´æ’å…¥ï¼Œè®¾ç½®æ’å…¥å…¨éƒ¨æ•°æ®åçš„æœ€åä¸€ä¸ªæ•°æ®èŠ‚ç‚¹åç½®èŠ‚ç‚¹ä¸ºsucc
            pred.next = succ;
            succ.prev = pred;
        }

        size += numNew;
        modCount++;
        return true;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="clear">clear()</h4>
<p><strong>clear()</strong>:ä»åˆ—è¡¨ä¸­åˆ é™¤æ‰€æœ‰å…ƒç´ ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>public void clear() {
        //å°†é“¾è¡¨ä¸­é—´çš„èŠ‚ç‚¹å†…å®¹éƒ½è®¾ç½®ä¸ºnull
        for (Node&lt;E&gt; x = first; x != null; ) {
            Node&lt;E&gt; next = x.next;
            x.item = null;
            x.next = null;
            x.prev = null;
            x = next;
        }
        //å°†é¦–ä½èŠ‚ç‚¹å’Œæœ«å°¾èŠ‚ç‚¹è®¾ç½®ä¸ºnullï¼Œå°ºå¯¸è®¾ç½®ä¸º0
        first = last = null;
        size = 0;
        modCount++;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<p>è¿˜æœ‰ä¸€äº›å…¶ä»–æ–¹æ³•ï¼Œä½†éƒ½æ˜¯åŸºäºä»¥ä¸Šæ–¹æ³•çš„é€»è¾‘ï¼Œå°±ä¸ä»‹ç»äº†ã€‚</p>

<h3 id="arraylistä»¥ä¸‹ä»£ç åŸºäºjava8">ArrayListï¼ˆä»¥ä¸‹ä»£ç åŸºäºJAVA8ï¼‰</h3>
<p><strong>ArrayList</strong>æ˜¯åŠ¨æ€æ•°ç»„ï¼Œåº•å±‚å°±æ˜¯ä¸€ä¸ªæ•°ç»„, å› æ­¤æŒ‰åºæŸ¥æ‰¾å¿«, ä¹±åºæ’å…¥, åˆ é™¤å› ä¸ºæ¶‰åŠåˆ°åé¢å…ƒç´ ç§»ä½æ‰€ä»¥æ€§èƒ½æ…¢ã€‚
é¦–å…ˆéœ€è¦ä»‹ç»ä¸€ä¸ª<strong>ArrayList</strong>æ–¹æ³•å†…å¸¸ç”¨çš„ä¸€ä¸ªæ–¹æ³•<strong>Arrays.copyOf(T[],int)</strong>ï¼Œä½œç”¨æ˜¯å¤åˆ¶æ•°ç»„ï¼Œåœ¨<strong>ArrayList</strong>åˆå§‹åŒ–ï¼Œæ‰©å®¹æ—¶éƒ½ä¼šç”¨åˆ°ï¼Œä»£ç å¦‚ä¸‹</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre> //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åŸå§‹æ•°ç»„ï¼Œç¬¬äºŒä¸ªæ˜¯è¿”å›æ•°ç»„çš„é•¿åº¦
 public static &lt;T&gt; T[] copyOf(T[] original, int newLength) {
        return (T[]) copyOf(original, newLength, original.getClass());
 }
 ////ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åŸå§‹æ•°ç»„ï¼Œç¬¬äºŒä¸ªæ˜¯è¿”å›æ•°ç»„çš„é•¿åº¦ï¼Œç¬¬ä¸‰ä¸ªè¿”å›æ•°ç»„çš„ç±»
 public static &lt;T,U&gt; T[] copyOf(U[] original, int newLength, Class&lt;? extends T[]&gt; newType) {
        @SuppressWarnings("unchecked")
        //åˆ¤æ–­è¿”å›æ•°ç»„çš„ç±»æ˜¯å¦æ˜¯Object,æ˜¯çš„è¯å°±åˆ›å»ºä¸€ä¸ªObjectæ•°ç»„ï¼Œä¸æ˜¯çš„è¯å°±åˆ›å»ºä¸€ä¸ªç‰¹å®šç±»çš„æ•°ç»„
        T[] copy = ((Object)newType == (Object)Object[].class)
            ? (T[]) new Object[newLength]
            : (T[]) Array.newInstance(newType.getComponentType(), newLength);
        //å°†originalä»ç¬¬0ä¸ªä¸‹æ ‡å¼€å§‹çš„Math.min(original.length, newLength)çš„æ•°æ®æ‹·è´è‡³copyæ•°ç»„çš„ç¬¬0ä¸ªä¸‹æ ‡
        System.arraycopy(original, 0, copy, 0,
                         Math.min(original.length, newLength));
        return copy;
 }

</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>ArrayList</strong>çš„çˆ¶ç±»æ¥å£ï¼Œä»¥åŠå†…éƒ¨æœ‰å‡ ä¸ªä¸»è¦çš„å˜é‡ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre> public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt;
        implements List&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable
    
 private static final int DEFAULT_CAPACITY = 10;//é»˜è®¤åˆå§‹å®¹é‡
 private static final Object[] EMPTY_ELEMENTDATA = {};//ç”¨äºç©ºå®ä¾‹çš„å…±äº«ç©ºæ•°ç»„å®ä¾‹ã€‚
 private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};
transient Object[] elementData;//å­˜å‚¨æ•°ç»„åˆ—è¡¨å…ƒç´ çš„æ•°ç»„ç¼“å†²åŒºã€‚
private int size;//å®é™…å…ƒç´ ä¸ªæ•°

 private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;//è¦åˆ†é…çš„æ•°ç»„çš„æœ€å¤§å¤§å°ï¼Œè¶…å‡ºçš„è¯å¯èƒ½ä¼šå¯¼è‡´OutOfMemoryError
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>EMPTY_ELEMENTDATA</strong>å’Œ<strong>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</strong>éƒ½æ˜¯ç©ºæ•°ç»„ï¼ŒåŒºåˆ«ä¸»è¦æ˜¯ä¸ºäº†åˆ¤æ–­æ˜¯ä½¿ç”¨äº†å“ªç§æ„é€ å‡½æ•°ï¼Œæ— å‚æ„é€ åˆ›å»ºæ—¶ä½¿ç”¨çš„æ˜¯<strong>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</strong>ï¼Œæœ‰å‚æ„é€ åˆ›å»ºæ—¶ï¼Œå½“<strong>initialCapacity == 0</strong>ä½¿ç”¨çš„æ˜¯<strong>EMPTY_ELEMENTDATA</strong>ã€‚ä»¥ä¾¿ç¡®è®¤å¦‚ä½•æ‰©å®¹(ä¸‹é¢ä¼šåˆ†æ)ã€‚</p>

<p><em>æ³¨ï¼šRandmoAccessæ¥å£ï¼Œå³æä¾›äº†éšæœºè®¿é—®åŠŸèƒ½ã€‚</em></p>
<h3 id="æ„é€ æ–¹æ³•-1">æ„é€ æ–¹æ³•</h3>
<p><strong>æ„é€ æ–¹æ³•</strong>:<strong>ArrayList</strong>æ„é€ æ–¹æ³•åˆ†ä¸ºä¸‰ä¸ªï¼š</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre>//ç½®ä¸ºDEFAULTCAPACITY_EMPTY_ELEMENTDATAçš„ç©ºåˆ—è¡¨ï¼Œä¹‹åä¼šåœ¨ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ æ—¶æ‰©å®¹æˆ10å®¹é‡ã€‚
public ArrayList() {
        this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;
    }
    
public ArrayList(int initialCapacity) {
        if (initialCapacity &gt; 0) {
            this.elementData = new Object[initialCapacity];
        } else if (initialCapacity == 0) {
            this.elementData = EMPTY_ELEMENTDATA;
        } else {
            throw new IllegalArgumentException("Illegal Capacity: "+
                                               initialCapacity);
        }
    }
/**
*   æŒ‰ç…§é›†åˆçš„è¿­ä»£å™¨è¿”å›å…ƒç´ çš„é¡ºåºæ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šé›†åˆå…ƒç´ çš„åˆ—è¡¨ã€‚
*/
 public ArrayList(Collection&lt;? extends E&gt; c) {
        //å°†é›†åˆè½¬æˆæ•°ç»„ç›´æ¥èµ‹å€¼ç»™elementData
        elementData = c.toArray();
        if ((size = elementData.length) != 0) {
            // c.toArray might (incorrectly) not return Object[] (see 6260652)
            if (elementData.getClass() != Object[].class)
                elementData = Arrays.copyOf(elementData, size, Object[].class);
        } else {
            // replace with empty array.
            this.elementData = EMPTY_ELEMENTDATA;
        }
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<ul>
  <li>ç©ºå‚æ„é€ æ–¹æ³•ï¼šå°†<strong>elementData</strong>è®¾ç½®ä¸º<strong>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</strong>ï¼Œæœ€åä¼šåˆå§‹åŒ–æˆä¸€ä¸ªå®¹é‡ä¸º10çš„ç©ºæ•°ç»„ï¼›</li>
  <li>å¸¦<strong>int</strong>å‚æ•°çš„æ„é€ æ–¹æ³•ï¼šå°†<strong>elementData</strong>å®ä¾‹åŒ–æˆä¼ å…¥çš„åˆå§‹å®¹é‡å¤§å°çš„æ•°ç»„ï¼Œè‹¥ä¼ å…¥çš„å€¼ä¸º0ï¼Œåˆ™å°†<strong>elementData</strong>è®¾ç½®ä¸º<strong>EMPTY_ELEMENTDATA</strong>ï¼›</li>
  <li>å¸¦<strong>Collection</strong>å‚æ•°çš„æ„é€ æ–¹æ³•ï¼šæŒ‰ç…§ä¼ å…¥çš„é›†åˆæ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šå…ƒç´ çš„åˆ—è¡¨ï¼Œrå°†é›†åˆè½¬æˆæ•°ç»„ç›´æ¥èµ‹å€¼ç»™<strong>elementData</strong>ï¼Œå°†å…ƒç´ ä¸ªæ•°èµ‹å€¼ç»™<strong>size</strong>ï¼Œè‹¥å…ƒç´ ä¸ªæ•°ä¸ä¸º0ï¼Œæœ€åå°†<strong>elementData</strong>è½¬æ¢æˆObject[]ç±»çš„æ•°ç»„ï¼Œè‹¥å…ƒç´ ä¸ªæ•°ä¸º0ï¼Œåˆ™å°†<strong>elementData</strong>ç½®ä¸º<strong>EMPTY_ELEMENTDATA</strong>ï¼›</li>
</ul>

<p>æ€»çš„æ¥è¯´ï¼š</p>
<ul>
  <li>æ— å‚æ„é€ :<strong>elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA</strong>;</li>
  <li>æœ‰å‚æ„é€ :</li>
  <li>
    <ul>
      <li><strong>initialCapacity==0, elementData = EMPTY_ELEMENTDATA</strong></li>
    </ul>
  </li>
  <li>
    <ul>
      <li><strong>initialCapacity &gt; 0, elementData = new Object[initialCapacity];</strong></li>
    </ul>
  </li>
</ul>

<p>ä»¥ä¸‹æ˜¯ä½¿ç”¨æ—¶çš„å¸¸ç”¨æ–¹æ³•å®ç°ä»£ç ä»¥åŠåˆ†æ:</p>
<h4 id="addeaddinte">add(E)/add(int,E)</h4>
<p><strong>add(E)</strong>:å°†æŒ‡å®šçš„å…ƒç´ æ·»åŠ åˆ°åˆ—è¡¨çš„æœ«å°¾ï¼Œè°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre></td><td class="rouge-code"><pre> public boolean add(E e) {
        //åˆ¤æ–­å¢åŠ ä¸€ä¸ªå…ƒç´ åçš„å®¹é‡æ˜¯å¦è¶…å‡ºå½“å‰æ•°ç»„å®¹é‡ï¼Œè¶…è¿‡æ‰©å®¹ï¼Œä¸è¶…è¿‡åˆ™ä¸å˜
        ensureCapacityInternal(size + 1);  // Increments modCount!!
        //å°†å½“å‰æ•°ç»„æœ€åä¸€ä¸ªæ•°æ®åçš„ä½ç½®èµ‹å€¼ä¸ºe
        elementData[size++] = e;
        return true;
 }
    
    private void ensureCapacityInternal(int minCapacity) {
        //åˆ¤æ–­å½“å‰elementDataæ˜¯å¦ç­‰äºDEFAULTCAPACITY_EMPTY_ELEMENTDATA
        if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {
            //å°†æ‰€éœ€å¤§å°è®¾ç½®æˆDEFAULT_CAPACITY(10)å’ŒminCapacityä¸­æ¯”è¾ƒå¤§çš„å€¼
            minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);
        }

        ensureExplicitCapacity(minCapacity);
    }
    
        private void ensureExplicitCapacity(int minCapacity) {
            modCount++;
        
            // å¦‚æœæ‰€éœ€çš„æœ€å°å®¹é‡å¤§äºå½“å‰elementDataçš„é•¿åº¦
            if (minCapacity - elementData.length &gt; 0)
            grow(minCapacity);
        }
        
    //æ ¹æ®minCapacity(éœ€è¦çš„æœ€å°å®¹é‡)æ‰©å®¹
    private void grow(int minCapacity) {
        // overflow-conscious code
        int oldCapacity = elementData.length;//è·å¾—å½“å‰æ•°ç»„é•¿åº¦
        int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1);//æ–°å®¹é‡ä¸ºåŸå®¹é‡çš„1.5å€
        if (newCapacity - minCapacity &lt; 0) 
            //å¦‚æœæ–°å®¹é‡ä»å°äºæ‰€éœ€æœ€å°å®¹é‡ï¼Œç›´æ¥å°†æ–°å®¹é‡ç½®ä¸ºéœ€è¦çš„æœ€å°å®¹é‡
            newCapacity = minCapacity;  
        if (newCapacity - MAX_ARRAY_SIZE &gt; 0)
            //åˆ¤æ–­å½“å‰å®¹é‡æ˜¯å¦è¶…å‡ºå¯åˆ†é…çš„æœ€å¤§å®¹é‡ï¼Œè¶…å‡ºåˆ™è®¾ç½®æ–°å®¹é‡ä¸º
            //Integer.MAX_VALUEï¼Œä¿è¯æ•°ç»„å®¹é‡ä¸è¶…è¿‡Integer.MAX_VALUE
            newCapacity = hugeCapacity(minCapacity);
            
        //æ ¹æ®æ–°å®¹é‡åˆ›å»ºæ–°çš„æ•°ç»„èµ‹å€¼ç»™elementDataï¼Œæ­¤æ—¶minCapacityé€šå¸¸æ¥è¿‘size
        elementData = Arrays.copyOf(elementData, newCapacity);
    }
    
    private static int hugeCapacity(int minCapacity) {
        if (minCapacity &lt; 0) // overflow
            throw new OutOfMemoryError();
        //Integer.MAX_VALUE = MAX_ARRAY_SIZE + 8;
        return (minCapacity &gt; MAX_ARRAY_SIZE) ?
            Integer.MAX_VALUE :
            MAX_ARRAY_SIZE;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>add(int,E)</strong>:åœ¨åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®æ’å…¥æŒ‡å®šçš„å…ƒç´ ã€‚å°†å½“å‰ä½äºè¯¥ä½ç½®çš„å…ƒç´ (å¦‚æœæœ‰çš„è¯)å’Œéšåçš„å…ƒç´ å‘å³ç§»åŠ¨(ä¸‹æ ‡åŠ 1)ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre> public void add(int index, E element) {
        //æ’å…¥ä½ç½®è¶…è¿‡å½“å‰æ•°æ®å°ºå¯¸æˆ–è€…æ’å…¥ä½ç½®å°äº0
        if (index &gt; size || index &lt; 0)
            throw new IndexOutOfBoundsException(outOfBoundsMsg(index));
        
        //åˆ¤æ–­æ’å…¥æ•°æ®åçš„æ•°æ®æ˜¯å¦è¶…å‡ºæ•°ç»„èŒƒå›´ï¼Œè¶…å‡ºåˆ™æ‰©å®¹ï¼Œä¸è¶…å‡ºåˆ™ä¸å˜
        ensureCapacityInternal(size + 1);  // Increments modCount!!
        //å°†elementDataæ•°ç»„ä»indexä»¥åŠä¹‹åçš„æ•°æ®æ‹·è´è‡³index+1çš„ä½ç½®
        //ç›¸å½“äºè…¾å‡ºindexè¿™ä¸ªä¸‹æ ‡çš„ä½ç½®ï¼Œç”¨äºå­˜æ”¾æ’å…¥çš„æ•°æ®element
        System.arraycopy(elementData, index, elementData, index + 1,
                         size - index);
        elementData[index] = element;
        size++;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="removeint-1">remove(int)</h4>
<p><strong>remove(int):</strong>:åˆ é™¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚å°†æ‰€æœ‰åç»­å…ƒç´ å‘å·¦ç§»åŠ¨(ä»å®ƒä»¬çš„ä¸‹æ ‡å‡å»1)ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre> public E remove(int index) {
        //åˆ¤æ–­æ˜¯å¦è¶…å‡ºèŒƒå›´
        if (index &gt;= size)
            throw new IndexOutOfBoundsException(outOfBoundsMsg(index));

        modCount++;
        //è·å¾—åˆ é™¤ä½ç½®çš„æ•°æ®
        E oldValue = (E) elementData[index];
        
        //åˆ é™¤åéœ€è¦ç§»åŠ¨çš„æ•°æ®æ•°é‡ã€‚
        //ä¾‹å…±10ä¸ªæ•°æ®ï¼Œåˆ é™¤ç¬¬5ä¸ªæ•°æ®(ä¸‹æ ‡index = 4)ï¼Œ
        //é‚£ä¹ˆéœ€è¦ç§»åŠ¨çš„æ•°æ®æ˜¯ç¬¬äº”ä¸ªæ•°æ®åçš„æ•°æ®ã€‚ä¹Ÿå°±æ˜¯10- 4 -1 =5 ä¸ªæ•°æ®
        int numMoved = size - index - 1;
        
        //éœ€è¦ç§»åŠ¨çš„æ•°æ®å¤§äº0
        if (numMoved &gt; 0)
            //å°†elementDataæ•°ç»„çš„ç¬¬index+1ä½ç½®å¼€å§‹çš„numMovedä¸ªæ•°æ®å¤åˆ¶åˆ°index(å³æ•°æ®å¾€å‰ç§»ä¸€ä½)
            System.arraycopy(elementData, index+1, elementData, index,
                             numMoved);
                            
        //æœ€åä¸€ä¸ªæ•°æ®ç½®ä¸ºnullï¼ŒåŒæ—¶size-1; 
        elementData[--size] = null; // clear to let GC do its work
        //è¿”å›åˆ é™¤çš„æ•°æ®
        return oldValue;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="gete">get(E)</h4>
<p><strong>get(E)</strong>:è¿”å›åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre> public E get(int index) {
        if (index &gt;= size)
            throw new IndexOutOfBoundsException(outOfBoundsMsg(index));
        
        return (E) elementData[index];
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="setinte-1">set(int,E)</h4>
<p><strong>set(int,E)</strong>:ç”¨æŒ‡å®šçš„å…ƒç´ æ›¿æ¢åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>public E set(int index, E element) {
        if (index &gt;= size)
            throw new IndexOutOfBoundsException(outOfBoundsMsg(index));

        E oldValue = (E) elementData[index];
        elementData[index] = element;
        return oldValue;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="addallcollection-extends-eaddallint--collection-extends-e-1">addAll(Collection&lt;? extends E&gt;)/addAll(int , Collection&lt;? extends E&gt;)</h4>
<p><strong>addAll(Collection&lt;? extends E&gt;)</strong>:å°†æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ è¿½åŠ åˆ°æœ«å°¾</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre> public boolean addAll(Collection&lt;? extends E&gt; c) {
        //å°†é›†åˆè½¬æˆæ•°ç»„ï¼Œå¹¶è·å–æ•°ç»„é•¿åº¦
        Object[] a = c.toArray();
        int numNew = a.length;
        
        //åˆ¤æ–­è¿½åŠ åå…ƒç´ æ˜¯å¦ä¼šè¶…å‡ºæ•°ç»„èŒƒå›´ï¼Œè¶…å‡ºåˆ™æ‰©å®¹
        ensureCapacityInternal(size + numNew);  // Increments modCount
        //å°†è¿½åŠ æ•°ç»„aä»0å¼€å§‹numNew(æ‰€æœ‰)æ•°æ®æ‹·è´è‡³elementDataçš„sizeä¸‹æ ‡å
        System.arraycopy(a, 0, elementData, size, numNew);
        size += numNew;
        //è¿”å›è¿½åŠ æ•°ç»„æ•°æ®æ˜¯å¦æœ‰æ•°æ®
        return numNew != 0;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>addAll(int , Collection&lt;? extends E&gt;)</strong>:å°†æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ æ’å…¥åˆ°æ­¤åˆ—è¡¨ä¸­ï¼Œä»æŒ‡å®šä½ç½®å¼€å§‹ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre>public boolean addAll(int index, Collection&lt;? extends E&gt; c) {
        if (index &gt; size || index &lt; 0)
            throw new IndexOutOfBoundsException(outOfBoundsMsg(index));
        //å°†é›†åˆè½¬æˆæ•°ç»„ï¼Œå¹¶è·å–æ•°ç»„é•¿åº¦
        Object[] a = c.toArray();
        int numNew = a.length;
        //åˆ¤æ–­æ’å…¥åå…ƒç´ æ˜¯å¦ä¼šè¶…å‡ºæ•°ç»„èŒƒå›´ï¼Œè¶…å‡ºåˆ™æ‰©å®¹
        ensureCapacityInternal(size + numNew);  // Increments modCount
        
        //æ’å…¥æ•°æ®åéœ€è¦ç§»åŠ¨çš„æ•°æ®é‡
        int numMoved = size - index;
        if (numMoved &gt; 0)
            //å°†elementDataæ•°ç»„çš„ç¬¬indexä½ç½®å¼€å§‹çš„numMovedä¸ªæ•°æ®å¤åˆ¶åˆ°index+numNew(å³æ•°æ®å¾€åç§»numNewä½)ï¼Œè…¾å‡ºnumNewä¸ªä½ç½®å­˜æ”¾æ’å…¥å…ƒç´ 
            System.arraycopy(elementData, index, elementData, index + numNew,
                             numMoved);
        //å°†aæ•°ç»„çš„æ•°æ®å¤åˆ¶è‡³elementDataåˆšæ‰è…¾å‡ºçš„ä½ç½®
        System.arraycopy(a, 0, elementData, index, numNew);
        size += numNew;
        return numNew != 0;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="clear-1">clear()</h4>
<p><strong>clear()</strong>:ä»åˆ—è¡¨ä¸­åˆ é™¤æ‰€æœ‰å…ƒç´ ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre> public void clear() {
        modCount++;

        // clear to let GC do its work
        for (int i = 0; i &lt; size; i++)
            elementData[i] = null;

        size = 0;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>ArrayList</strong>å†…éƒ¨è¿˜æœ‰ä¸€ä¸ªç”¨äºåˆ†é¡µæŸ¥çœ‹çš„<strong>SubList</strong>çš„å†…éƒ¨ç±»ï¼Œåœ¨<strong>subList(int,int)</strong>å†…éƒ¨ä¼šè°ƒç”¨ï¼Œä½œç”¨æ˜¯è¿”å›ä¸€ä¸ªListé›†åˆçš„å…¶ä¸­ä¸€éƒ¨åˆ†è§†å›¾ã€‚æœ¬è´¨ä¹Ÿæ˜¯å¯¹<strong>elementData</strong>è¿™ä¸ªæ•°ç»„è¿›è¡Œæ“ä½œï¼Œè¿™é‡Œå°±ä¸å±•å¼€ã€‚</p>

<p><em>æ³¨ï¼šåœ¨æ— å‚åˆå§‹åŒ–ArrayListæ—¶ï¼ŒJava7æ˜¯ç›´æ¥åˆå§‹åŒ–10å¤§å°çš„æ•°ç»„ï¼Œè€ŒJAVA8æ˜¯åˆå§‹åŒ–ç©ºæ•°ç»„ï¼Œåœ¨ç¬¬ä¸€æ¬¡æ‰©å®¹æ—¶æ‰æŒ‰ç…§10è¿›è¡Œæ‰©å®¹</em></p>
<h3 id="vector">Vector</h3>
<p><strong>Vector</strong>æ˜¯çŸ¢é‡é˜Ÿåˆ—ï¼Œä¸<strong>ArrayList</strong>ä¸åŒï¼Œ<strong>Vector</strong>ä¸­çš„æ“ä½œæ˜¯<strong>çº¿ç¨‹å®‰å…¨</strong>çš„ã€‚
<strong>Vector</strong>çš„çˆ¶ç±»æ¥å£ï¼Œä»¥åŠå†…éƒ¨æœ‰å‡ ä¸ªä¸»è¦çš„å˜é‡ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>public class Vector&lt;E&gt;
    extends AbstractList&lt;E&gt;
    implements List&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable
    
    protected Object[] elementData;//å­˜å‚¨çŸ¢é‡ç»„ä»¶çš„æ•°ç»„ç¼“å†²åŒºã€‚
    protected int elementCount;//å®é™…å…ƒç´ ä¸ªæ•°
    protected int capacityIncrement;//capacityIncrementæ˜¯æ¯æ¬¡Vectorå®¹é‡å¢åŠ æ—¶çš„å¢é‡å€¼ï¼Œå¦‚æœ&lt;=0ï¼Œåˆ™æ¯æ¬¡æ‰©å®¹æ—¶å®¹é‡ç¿»å€ï¼Œå¦åˆ™å°±æ‰©å®¹åå®¹é‡å°±åªæ˜¯å®¹é‡+å¢é‡ã€‚
    private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;//è¦åˆ†é…çš„æ•°ç»„çš„æœ€å¤§å¤§å°ï¼Œè¶…å‡ºçš„è¯å¯èƒ½ä¼šå¯¼è‡´OutOfMemoryError
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="æ„é€ æ–¹æ³•-2">æ„é€ æ–¹æ³•</h4>
<p><strong>æ„é€ æ–¹æ³•</strong>:<strong>Vector</strong>æ„é€ æ–¹æ³•åˆ†ä¸ºä¸‰ä¸ªï¼š</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre> public Vector() {
        //åˆå§‹åŒ–å®¹é‡ä¸º10
        this(10);
    }
    
 public Vector(int initialCapacity) {
        //åˆå§‹åŒ–å¢é‡ä¸º0
        this(initialCapacity, 0);
    }
    
 public Vector(int initialCapacity, int capacityIncrement) {
        super();
        if (initialCapacity &lt; 0)
            throw new IllegalArgumentException("Illegal Capacity: "+
                                               initialCapacity);
        this.elementData = new Object[initialCapacity];
        this.capacityIncrement = capacityIncrement;
    }
    
 public Vector(Collection&lt;? extends E&gt; c) {
        elementData = c.toArray();
        elementCount = elementData.length;
        // c.toArray might (incorrectly) not return Object[] (see 6260652)
        if (elementData.getClass() != Object[].class)
            elementData = Arrays.copyOf(elementData, elementCount, Object[].class);
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<p>å‰ä¸‰ä¸ªæ„é€ æ–¹æ³•æœ¬è´¨æ˜¯è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼šåˆå§‹åŒ–ä¸€ä¸ªç‰¹å®šå®¹é‡çš„æ•°ç»„ï¼Œåˆå§‹åŒ–ç‰¹å®šå¢é‡å€¼ï¼Œå…·ä½“çš„åˆå§‹åŒ–å‚æ•°çœ‹æºç ï¼›</p>

<p>å¸¦<strong>Collection</strong>å‚æ•°çš„æ„é€ æ–¹æ³•ï¼šæŒ‰ç…§ä¼ å…¥çš„é›†åˆæ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šå…ƒç´ çš„åˆ—è¡¨ï¼Œrå°†é›†åˆè½¬æˆæ•°ç»„ç›´æ¥èµ‹å€¼ç»™<strong>elementData</strong>ï¼Œå°†å…ƒç´ ä¸ªæ•°èµ‹å€¼ç»™<strong>elementCount</strong>ï¼Œæœ€åå°†<strong>elementData</strong>è½¬æ¢æˆObject[]ç±»çš„æ•°ç»„ï¼›</p>
<h4 id="addeaddinte-1">add(E)/add(int,E)</h4>
<p><strong>add(E)</strong>:å°†æŒ‡å®šçš„å…ƒç´ æ·»åŠ åˆ°Vectorçš„æœ«å°¾ã€‚<strong>synchronized</strong>æ–¹æ³•ï¼Œçº¿ç¨‹å®‰å…¨ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre>  public synchronized boolean add(E e) {
        modCount++;
        //å®¹é‡åˆ¤æ–­ï¼Œå®¹é‡ä¸å¤Ÿåˆ™æ‰©å®¹ï¼Œä¸ç„¶åˆ™ä¸å˜
        ensureCapacityHelper(elementCount + 1);
        elementData[elementCount++] = e;
        return true;
    }
    
  private void ensureCapacityHelper(int minCapacity) {
        // overflow-conscious code
        if (minCapacity - elementData.length &gt; 0)
            grow(minCapacity);
    }
    
  private void grow(int minCapacity) {
        // overflow-conscious code
        int oldCapacity = elementData.length;
        //å¦‚æœè®¾å®šçš„capacityIncrementå¢é‡å¤§äº0ï¼Œåˆ™æ–°å®¹é‡ä¸ºæ—§å®¹é‡+å¢é‡ï¼Œå¦åˆ™ä¸ºåŒå€æ—§å®¹é‡
        int newCapacity = oldCapacity + ((capacityIncrement &gt; 0) ?
                                         capacityIncrement : oldCapacity);
        //åˆ¤æ–­æ–°å®¹é‡æ˜¯å¦å¤§äºæ‰€éœ€çš„æœ€å°å®¹é‡ï¼Œå°äºåˆ™æ–°å®¹é‡æ”¹ä¸ºminCapacity
        if (newCapacity - minCapacity &lt; 0)
            newCapacity = minCapacity;
        //åˆ¤æ–­æ–°å®¹é‡æ˜¯å¦è¶…å‡º
        if (newCapacity - MAX_ARRAY_SIZE &gt; 0)
            //åˆ¤æ–­å½“å‰å®¹é‡æ˜¯å¦è¶…å‡ºå¯åˆ†é…çš„æœ€å¤§å®¹é‡ï¼Œè¶…å‡ºåˆ™è®¾ç½®æ–°å®¹é‡ä¸º
            //Integer.MAX_VALUEï¼Œä¿è¯æ•°ç»„å®¹é‡ä¸è¶…è¿‡Integer.MAX_VALUE
            newCapacity = hugeCapacity(minCapacity);
        elementData = Arrays.copyOf(elementData, newCapacity);
    }
    
  private static int hugeCapacity(int minCapacity) {
        if (minCapacity &lt; 0) // overflow
            throw new OutOfMemoryError();
        return (minCapacity &gt; MAX_ARRAY_SIZE) ?
            Integer.MAX_VALUE :
            MAX_ARRAY_SIZE;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>add(int,E)</strong>ï¼šåœ¨Vectorçš„æŒ‡å®šä½ç½®æ’å…¥æŒ‡å®šå…ƒç´ ã€‚è¯¥æ–¹æ³•å†…éƒ¨è°ƒç”¨çš„æ–¹æ³•æœ‰<strong>synchronized</strong>ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre> public void add(int index, E element) {
        insertElementAt(element, index);
    }
 /**
  * åœ¨æŒ‡å®šçš„{@code index}å¤„å°†æŒ‡å®šçš„å¯¹è±¡ä½œä¸ºè¿™ä¸ªå‘é‡ä¸­çš„ç»„ä»¶æ’å…¥ã€‚
  *è¿™ä¸ªå‘é‡ä¸­çš„æ¯ä¸ªç´¢å¼•å€¼å¤§äºæˆ–ç­‰äºæŒ‡å®šçš„{@code index}çš„ç»„ä»¶å‘ä¸Šç§»åŠ¨ï¼Œä½¿å…¶ç´¢å¼•å€¼æ¯”ä¹‹å‰çš„å€¼å¤§1ã€‚
  */
 public synchronized void insertElementAt(E obj, int index) {
        modCount++;
        //åˆ¤æ–­æ’å…¥ä½ç½®æ˜¯å¦è¶…å‡ºèŒƒå›´
        if (index &gt; elementCount) {
            throw new ArrayIndexOutOfBoundsException(index
                                                     + " &gt; " + elementCount);
        }
        //å®¹é‡åˆ¤æ–­ï¼Œå®¹é‡ä¸å¤Ÿåˆ™æ‰©å®¹ï¼Œä¸ç„¶åˆ™ä¸å˜
        ensureCapacityHelper(elementCount + 1);
        //è…¾å‡ºæ•°ç»„ä¸­indexä¸‹æ ‡ä½ç½®
        System.arraycopy(elementData, index, elementData, index + 1, elementCount - index);
        //å°†objæ’å…¥è¿™ä¸ªä½ç½®
        elementData[index] = obj;
        elementCount++;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="removeint-2">remove(int)</h4>
<p><strong>remove(int)</strong>:ç§»é™¤Vectorä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚çº¿ç¨‹å®‰å…¨</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre> public synchronized E remove(int index) {
        modCount++;
        if (index &gt;= elementCount)
            throw new ArrayIndexOutOfBoundsException(index);
        E oldValue = elementData(index);
        
        //numMovedéœ€è¦ç§»åŠ¨çš„æ•°æ®æ•°é‡
        int numMoved = elementCount - index - 1;
        if (numMoved &gt; 0)
            System.arraycopy(elementData, index+1, elementData, index,
                             numMoved);
        elementData[--elementCount] = null; // Let gc do its work

        return oldValue;
    }

</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="gete-1">get(E)</h4>
<p><strong>get(E)</strong>:è¿”å›è¯¥Vectorä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚çº¿ç¨‹å®‰å…¨</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre> public synchronized E get(int index) {
        if (index &gt;= elementCount)
            throw new ArrayIndexOutOfBoundsException(index);

        return elementData(index);
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="setinte-2">set(int,E)</h4>
<p><strong>set(int,E)</strong>:ç”¨æŒ‡å®šçš„å…ƒç´ æ›¿æ¢Vectorä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre> public synchronized E set(int index, E element) {
        if (index &gt;= elementCount)
            throw new ArrayIndexOutOfBoundsException(index);

        E oldValue = elementData(index);
        elementData[index] = element;
        return oldValue;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="addallcollection-extends-eaddallint--collection-extends-e-2">addAll(Collection&lt;? extends E&gt;)/addAll(int , Collection&lt;? extends E&gt;)</h4>
<p><strong>addAll(Collection&lt;? extends E&gt;)</strong>ï¼šå°†æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ è¿½åŠ åˆ°æœ«å°¾ï¼Œçº¿ç¨‹å®‰å…¨</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre> public synchronized boolean addAll(Collection&lt;? extends E&gt; c) {
        modCount++;
        Object[] a = c.toArray();
        int numNew = a.length;
        //åˆ¤æ–­å®¹é‡
        ensureCapacityHelper(elementCount + numNew);
        //æ‹·è´æ•°æ®
        System.arraycopy(a, 0, elementData, elementCount, numNew);
        elementCount += numNew;
        return numNew != 0;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>addAll(int , Collection&lt;? extends E&gt;)</strong>:å°†æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ æ’å…¥åˆ°Vectorçš„æŒ‡å®šä½ç½®ã€‚çº¿ç¨‹å®‰å…¨</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre>  public synchronized boolean addAll(int index, Collection&lt;? extends E&gt; c) {
        modCount++;
        if (index &lt; 0 || index &gt; elementCount)
            throw new ArrayIndexOutOfBoundsException(index);

        Object[] a = c.toArray();
        int numNew = a.length;
        //åˆ¤æ–­å®¹é‡
        ensureCapacityHelper(elementCount + numNew);
        //è®¡ç®—éœ€è¦ç§»åŠ¨çš„å…ƒç´ æ•°é‡
        int numMoved = elementCount - index;
        if (numMoved &gt; 0)
            //ç§»åŠ¨æ•°æ®ï¼Œè…¾å‡ºnumNewä¸ªä½ç½®
            System.arraycopy(elementData, index, elementData, index + numNew,
                             numMoved);
        //æ‹·è´æ•°æ®è‡³è…¾å‡ºçš„ä½ç½®
        System.arraycopy(a, 0, elementData, index, numNew);
        elementCount += numNew;
        return numNew != 0;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="clear-2">clear();</h4>
<p><strong>clear()</strong>:ä»Vectorä¸­åˆ é™¤æ‰€æœ‰å…ƒç´ ã€‚çº¿ç¨‹å®‰å…¨</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre> public void clear() {
        removeAllElements();
    }
    
 public synchronized void removeAllElements() {
        modCount++;
        // Let gc do its work
        for (int i = 0; i &lt; elementCount; i++)
            elementData[i] = null;

        elementCount = 0;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<p>ä»ä»£ç å¯ä»¥å¾—çŸ¥ï¼Œå…¶å®<strong>Vector</strong>å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„<strong>ArrayList</strong>ï¼Œæ–¹æ³•å†…çš„ä»£ç é€»è¾‘åŸºæœ¬ä¸€è‡´ï¼Œå°±æ˜¯å¤šå¢åŠ äº†<strong>synchronized</strong>å…³é”®å­—ã€‚åŒæ—¶å› ä¸º<strong>Vector</strong>æ˜¯åŒæ­¥çš„ï¼Œå½“ä¸€ä¸ª<strong>Iterator</strong>è¢«åˆ›å»ºè€Œä¸”æ­£åœ¨è¢«ä½¿ç”¨ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æ”¹å˜äº†<strong>Vector</strong>çš„çŠ¶æ€ï¼ˆä¾‹å¦‚ï¼Œæ·»åŠ æˆ–åˆ é™¤äº†ä¸€äº›å…ƒç´ ï¼‰ï¼Œè¿™æ—¶è°ƒç”¨<strong>Iterator</strong>çš„æ–¹æ³•æ—¶å°†æŠ›å‡º<strong>ConcurrentModificationException</strong>ï¼Œå› æ­¤å¿…é¡»æ•è·è¯¥å¼‚å¸¸ã€‚</p>
<h3 id="stack">Stack</h3>
<p><strong>Stack</strong>ç»§æ‰¿è‡ª<strong>Vector</strong>ï¼Œå®ç°ä¸€ä¸ª<strong>åè¿›å…ˆå‡º</strong>çš„å †æ ˆã€‚<strong>Stack</strong>æä¾›5ä¸ªé¢å¤–çš„æ–¹æ³•ä½¿å¾—<strong>Vector</strong>å¾—ä»¥è¢«å½“ä½œå †æ ˆä½¿ç”¨ã€‚åŸºæœ¬çš„<strong>push</strong>å’Œ<strong>pop</strong>æ–¹æ³•ï¼Œè¿˜æœ‰<strong>peek</strong>æ–¹æ³•å¾—åˆ°æ ˆé¡¶çš„å…ƒç´ ï¼Œ<strong>empty</strong>æ–¹æ³•æµ‹è¯•å †æ ˆæ˜¯å¦ä¸ºç©ºï¼Œ<strong>search</strong>æ–¹æ³•æ£€æµ‹ä¸€ä¸ªå…ƒç´ åœ¨å †æ ˆä¸­çš„ä½ç½®ã€‚<strong>Stack</strong>åˆšåˆ›å»ºåæ˜¯ç©ºæ ˆã€‚</p>
<h4 id="æ„é€ æ–¹æ³•-3">æ„é€ æ–¹æ³•</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre> //åˆ›å»ºä¸€ä¸ªç©ºå †æ ˆã€‚
 public Stack() {
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="pushe">push(E)</h4>
<p><strong>push(E)</strong>:å°†Eæ¨åˆ°å †æ ˆçš„é¡¶éƒ¨.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre> public E push(E item) {
        addElement(item);

        return item;
    }
 //Vectorçš„æ–¹æ³•
 public synchronized void addElement(E obj) {
        modCount++;
        ensureCapacityHelper(elementCount + 1);
        elementData[elementCount++] = obj;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="peek">peek()</h4>
<p><strong>peek()</strong>:æŸ¥çœ‹å †æ ˆé¡¶éƒ¨çš„å¯¹è±¡ï¼Œè€Œä¸å°†å…¶ä»å †æ ˆä¸­ç§»é™¤ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre> public synchronized E peek() {
        int     len = size();

        if (len == 0)
            throw new EmptyStackException();
        return elementAt(len - 1);
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="pop">pop()</h4>
<p><strong>pop()</strong>:åˆ é™¤å †æ ˆé¡¶éƒ¨çš„å¯¹è±¡ï¼Œå¹¶å°†è¯¥å¯¹è±¡ä½œä¸ºå‡½æ•°çš„å€¼è¿”å›ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre>     public synchronized E pop() {
        E       obj;
        int     len = size();

        obj = peek();
        removeElementAt(len - 1);

        return obj;
    }
    
    //Vectorä¸­çš„æ–¹æ³•ï¼Œç§»é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ ï¼Œå¹¶å°†ä¹‹åçš„æ•°æ®å‘å‰ç§»åŠ¨ä¸€ä½
    public synchronized void removeElementAt(int index) {
        modCount++;
        if (index &gt;= elementCount) {
            throw new ArrayIndexOutOfBoundsException(index + " &gt;= " +
                                                     elementCount);
        }
        else if (index &lt; 0) {
            throw new ArrayIndexOutOfBoundsException(index);
        }
        int j = elementCount - index - 1;
        if (j &gt; 0) {
            System.arraycopy(elementData, index + 1, elementData, index, j);
        }
        elementCount--;
        elementData[elementCount] = null; /* to let gc do its work */
    }
    
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="empty">empty()</h4>
<p><strong>empty()</strong>:æŸ¥çœ‹æ­¤å †æ ˆæ˜¯å¦ä¸ºç©ºã€‚æœ¬è´¨æ˜¯çœ‹æ•°æ®sizeæ˜¯å¦ä¸º0</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre> public boolean empty() {
        return size() == 0;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="searchobject">search(Object)</h4>
<p><strong>search(Object)</strong>:è¿”å›å¯¹è±¡åœ¨å †æ ˆä¸­çš„åŸºäº1(å³æ ˆé¡¶)çš„ä½ç½®ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>public synchronized int search(Object o) {
        int i = lastIndexOf(o);
        
        
        if (i &gt;= 0) {
            return size() - i;
        }
        return -1;
    }
//Vectorä¸­çš„æ–¹æ³•,è¿”å›Vectorä¸­æŒ‡å®šå…ƒç´ æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœvectorä¸­ä¸åŒ…å«è¯¥å…ƒç´ ï¼Œåˆ™è¿”å›-1ã€‚
public synchronized int lastIndexOf(Object o) {
        return lastIndexOf(o, elementCount-1);
    }
//Vectorä¸­çš„æ–¹æ³•,ä»indexå¾€å›æœç´¢å€¼ç­‰äºoçš„å…ƒç´ ï¼Œè¿”å›Vectorä¸­æŒ‡å®šå…ƒç´ æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°è¯¥å…ƒç´ åˆ™è¿”å›-1ã€‚
public synchronized int lastIndexOf(Object o, int index) {
        if (index &gt;= elementCount)
            throw new IndexOutOfBoundsException(index + " &gt;= "+ elementCount);

        if (o == null) {
            for (int i = index; i &gt;= 0; i--)
                if (elementData[i]==null)
                    return i;
        } else {
            for (int i = index; i &gt;= 0; i--)
                if (o.equals(elementData[i]))
                    return i;
        }
        return -1;
    }
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="set">Set</h2>
<p><strong>Set</strong>æ˜¯ä¸€ç§ä¸åŒ…å«é‡å¤çš„å…ƒç´ çš„<strong>Collection</strong>ï¼Œå³ä»»æ„çš„ä¸¤ä¸ªå…ƒç´ e1å’Œe2éƒ½æœ‰e1.equals(e2)=falseï¼Œ<strong>Set</strong>æœ€å¤šæœ‰ä¸€ä¸ª<strong>null</strong>å…ƒç´ ã€‚</p>
<h3 id="hashset">HashSet</h3>
<p><strong>HashSet</strong>è¿™ä¸ªç±»å®ç°äº†<strong>Set</strong>é›†åˆï¼Œå®é™…å†…éƒ¨æ˜¯ä½¿ç”¨<strong>HashMap</strong>çš„å®ä¾‹ã€‚<strong>HashSet</strong>ä¸­å¯¹é‡å¤å…ƒç´ çš„ç†è§£ï¼šå’Œé€šå¸¸æ„ä¹‰ä¸Šçš„ç†è§£ä¸å¤ªä¸€æ ·ï¼
ä¸¤ä¸ªå…ƒç´ ï¼ˆå¯¹è±¡ï¼‰çš„<strong>hashCode</strong>è¿”å›å€¼ç›¸åŒï¼Œå¹¶ä¸”<strong>equals</strong>è¿”å›å€¼ä¸º<strong>true</strong>æ—¶ï¼ˆæˆ–è€…<strong>åœ°å€</strong>ç›¸åŒæ—¶ï¼‰ï¼Œæ‰ç§°è¿™ä¸¤ä¸ªå…ƒç´ æ˜¯ç›¸åŒçš„ã€‚
<strong>HashSet</strong>çš„çˆ¶ç±»æ¥å£ï¼Œä»¥åŠå†…éƒ¨æœ‰å‡ ä¸ªä¸»è¦çš„å˜é‡ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>public class HashSet&lt;E&gt;
    extends AbstractSet&lt;E&gt;
    implements Set&lt;E&gt;, Cloneable, java.io.Serializable
    
    private transient HashMap&lt;E,Object&gt; map;
    //HashMapæ¯ä¸ªé”®å€¼å¯¹åº”çš„value
    private static final Object PRESENT = new Object();
</pre></td></tr></tbody></table></code></pre></div></div>
<p>å¯ä»¥çœ‹åˆ°<strong>HashSet</strong>å†…éƒ¨å…¶å®æ˜¯ç”±<strong>HashMap</strong>ç»„æˆï¼Œ<strong>HashMap</strong>æ˜¯ä¸€ç§å­˜å‚¨é”®å€¼å¯¹çš„å“ˆå¸Œè¡¨.</p>
<h4 id="æ„é€ æ–¹æ³•-4">æ„é€ æ–¹æ³•</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre> //æ„é€ ä¸€ä¸ªæ–°çš„ç©ºé›†åˆ;æ”¯æŒHashMapå®ä¾‹å…·æœ‰é»˜è®¤åˆå§‹å®¹é‡(16)å’Œè´Ÿè½½ç³»æ•°(0.75)ã€‚
 public HashSet() {
        map = new HashMap&lt;&gt;();
    }
 //æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šå…ƒç´ çš„çš„æ–°é›†åˆ;åˆ›å»ºçš„HashMapå®ä¾‹å…·æœ‰é»˜è®¤åˆå§‹å®¹é‡(16å’Œc.size()/.75f(åè€…çº¦ä¸ºc.size()çš„1.3å€)ä¸¤è€…ä¸­çš„æœ€å¤§å€¼)å’Œè´Ÿè½½ç³»æ•°(0.75)ã€‚
 public HashSet(Collection&lt;? extends E&gt; c) {
        map = new HashMap&lt;&gt;(Math.max((int) (c.size()/.75f) + 1, 16));
        addAll(c);
    }
 //æ„é€ ä¸€ä¸ªæ–°çš„ç©ºé›†åˆ;å†…éƒ¨æ„é€ æŒ‡å®šåˆå§‹å®¹é‡çš„HashMapå®ä¾‹
 public HashSet(int initialCapacity) {
        map = new HashMap&lt;&gt;(initialCapacity);
    }
    
 //æ„é€ ä¸€ä¸ªæ–°çš„ç©ºé›†åˆ;å†…éƒ¨æ„é€ æŒ‡å®šåˆå§‹å®¹é‡å’ŒæŒ‡å®šè´Ÿè½½ç³»æ•°çš„HashMapå®ä¾‹
 public HashSet(int initialCapacity, float loadFactor) {
        map = new HashMap&lt;&gt;(initialCapacity, loadFactor);
    }

 //æ„é€ ä¸€ä¸ªæ–°çš„ã€ç©ºçš„é“¾æ¥å“ˆå¸Œé›†ã€‚(è¿™ä¸ªåŒ…çš„ç§æœ‰æ„é€ å‡½æ•°ä»…ç”±LinkedHashSetä½¿ç”¨ã€‚)åå¤‡HashMapå®ä¾‹æ˜¯å…·æœ‰æŒ‡å®šåˆå§‹å®¹é‡å’ŒæŒ‡å®šè´Ÿè½½ç³»æ•°çš„LinkedHashMapã€‚ 
 HashSet(int initialCapacity, float loadFactor, boolean dummy) {
        map = new LinkedHashMap&lt;&gt;(initialCapacity, loadFactor);
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="addeaddinte-2">add(E)/add(int,E)</h4>
<p><strong>add(E)</strong>:å¦‚æœEè¿˜ä¸å­˜åœ¨çš„è¯ï¼Œå°†æŒ‡å®šçš„å…ƒç´ æ·»åŠ åˆ°è¿™ä¸ªé›†åˆä¸­ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™å€¼ä¸å˜ç›´æ¥è¿”å›false;</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>  public boolean add(E e) {
        return map.put(e, PRESENT)==null;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<p>ä»£ç å¯ä»¥çœ‹å‡º</p>
<h4 id="removeintå¦‚æœæŒ‡å®šçš„å…ƒç´ å­˜åœ¨åˆ™ä»é›†åˆä¸­ç§»é™¤è¯¥å…ƒç´ è¿”å›é›†åˆä¸­æ˜¯å¦åŒ…å«æ­¤å…ƒç´ ">remove(int):å¦‚æœæŒ‡å®šçš„å…ƒç´ å­˜åœ¨ï¼Œåˆ™ä»é›†åˆä¸­ç§»é™¤è¯¥å…ƒç´ ã€‚è¿”å›é›†åˆä¸­æ˜¯å¦åŒ…å«æ­¤å…ƒç´ ã€‚</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>   public boolean remove(Object o) {
        return map.remove(o)==PRESENT;
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="containsobject">contains(Object)</h4>
<p><strong>contains(Object)</strong>:è¿”å›<strong>HashSet</strong>ä¸­æ˜¯å¦åŒ…å«æ­¤å…ƒç´ </p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>  public boolean contains(Object o) {
        return map.containsKey(o);
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="clear-3">clear()</h4>
<p><strong>clear()</strong>:ä»é›†åˆä¸­åˆ é™¤æ‰€æœ‰å…ƒç´ ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre> public void clear() {
        map.clear();
    }
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="æ€»ç»“">æ€»ç»“</h4>
<p><strong>HashSet</strong>åŸºæœ¬æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯ç›´æ¥è°ƒç”¨<strong>HashMap</strong>çš„æ–¹æ³•ï¼Œä¸ºäº†ä¿è¯æ•°æ®ä¸é‡å¤ï¼Œé‡‡ç”¨äº†å­˜å‚¨æ—¶ç”¨<strong>key</strong>å­˜å‚¨çš„æ–¹æ³•ï¼Œå†<strong>HashMap</strong>ä¸­,<strong>key</strong>æ˜¯ä¸é‡å¤çš„ï¼Œæ‰€ä»¥<strong>HashSet</strong>å°±ä¸ä¼šæœ‰å­˜å‚¨é‡å¤çš„æ•°æ®äº†ã€‚
<em>HashSetæ˜¯çº¿ç¨‹ä¸åŒæ­¥çš„</em></p>
<h3 id="treeset">TreeSet</h3>
<p><strong>TreeSet</strong>æ˜¯ä¸€ä¸ªæœ‰åºçš„é›†åˆï¼Œå®ƒçš„ä½œç”¨æ˜¯æä¾›æœ‰åºçš„Seté›†åˆã€‚<strong>TreeSet</strong>çš„å…ƒç´ æ”¯æŒ2ç§æ’åºæ–¹å¼ï¼šè‡ªç„¶æ’åºæˆ–è€…æ ¹æ®æä¾›çš„Comparatorè¿›è¡Œæ’åºã€‚</p>
:ET